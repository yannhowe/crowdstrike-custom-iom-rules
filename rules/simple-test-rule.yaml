# Simple test rule for debugging
rule:
  name: "Simple-Test-Rule"
  description: "Simple test rule to verify API functionality"
  resource_type: "AWS::EC2::Instance"
  platform: "AWS"
  provider: "AWS"
  domain: "CSPM"
  subdomain: "IOM"
  severity: 2
  
  logic: |
    package crowdstrike
    
    default result = "fail"
    
    result = "pass" if {
        input.resource.state == "running"
    }
    
    violation contains {"msg": msg} if {
        not input.resource.state == "running"
        msg := "EC2 instance must be in running state"
    }
  
  alert_info: "Simple test rule for API validation"
  remediation: "Ensure EC2 instance is in running state"